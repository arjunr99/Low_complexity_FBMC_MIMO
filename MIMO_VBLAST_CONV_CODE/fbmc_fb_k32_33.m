%%% Use the appropriate k value and shift_pts to change the spectral efficiencies


function [ft]=fbmc_fb_k32_33(Ncarriers)
over = 32;
N = Ncarriers * 33/32;

%load('r.mat')
%k for 32/32
%k = [-0.923432319693332,0.928212089889573,-0.924351832951611,0.928095564919407,-0.924671721891248,0.927754806222493,-0.925156067437106,0.927079921041436,-0.926033708616885,0.925729784922107,-0.927834017405659,0.922605061506199,-0.932455768395117,0.912209880070321,-0.951605543854622,0.575481628018062,0.0623280058674773,0.0373646832723204,0.0350295098762134,0.0206037421519965,0.0263655119430615,0.0148138177742021,0.0224313273816780,0.0119781715874528,0.0202478266140483,0.0103739652703394,0.0188793244368491,0.00941808471172816,0.0178424703782578,0.00886979860280955,0.0156601990154643];
%k for 32/33
k = [-0.994799074667869,0.993465513336445,-0.994850980322617,0.993379121002287,-0.994965188500874,0.993210182162132,-0.995182125506632,0.992895573656688,-0.995594694040224,0.992271386696032,-0.996466057936007,0.990806900158844,-0.998777042816508,0.985985164714942,-1.00428996441853,0.690377388429708,-0.0462750340759074,-0.00469941456811598,0.000645075613253134,-0.00126681526060149,0.000551622071353326,-0.00171536110949260,5.32020608434736e-05,-0.00214625123791262,-0.000339246432021619,-0.00248671063590137,-0.000656600691985495,-0.00277654431622669,-0.000939862676875029,-0.00304872904520153,-0.00122175465906536];
%k for 32/34
%k = [-0.998374067573721,0.999804388656024,-0.998387637757420,0.999783343238394,-0.998420007220850,0.999737193315184,-0.998485808650260,0.999641987515522,-0.998623775883211,0.999433114940933,-0.998944799138263,0.998906352533106,-0.999827316309396,0.997446272837834,-0.991198949171575,0.705992045977699,-0.135646593758167,-0.0112672659691154,-0.00242601610299085,-0.000750863838988504,0.000209213029431574,0.000369314798480963,0.000773951975258448,0.000700775263791926,0.000974200796796696,0.000837148453873618,0.00106553425381144,0.000905593269769790,0.00111493268791143,0.000945095159037601,0.00114438566419917];

shift_pts = 1;
%% shift_pts = 0 for 32/32, 1 for 32/33, 2 for 32/34

H1 =[1 k(1:31) zeros(1,(N-2)*over+1) k(31:-1:1)];

y1 = ifft(H1);

nor = sqrt(y1*y1');
y1 = y1/nor;

dft_mtx = exp(2j*pi/(over*N)*(0:over*N-1)'*(0:over+shift_pts:over*N-1));

y1 = repmat(y1.',1,Ncarriers);

ft = y1.*dft_mtx;

end
